{"version":3,"sources":["../../data/database.js"],"names":["addTodo","changeTodoStatus","getTodo","getTodos","getUser","getViewer","markAllTodos","removeTodo","removeCompletedTodos","renameTodo","Todo","User","VIEWER_ID","viewer","id","usersById","todosById","todoIdsByUser","nextTodoId","text","complete","todo","push","emit","status","todos","map","filter","changedTodos","forEach","todoIndex","indexOf","splice","todosToRemove"],"mappings":"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","file":"database.js","sourcesContent":["export class Todo { }\nexport class User { }\n\nimport events from '../server/events';\n// Mock authenticated ID\nconst VIEWER_ID = 'me';\n\n// Mock user data\nconst viewer = new User();\nviewer.id = VIEWER_ID;\nconst usersById = {\n  [VIEWER_ID]: viewer,\n};\n\n// Mock todo data\nconst todosById = {};\nconst todoIdsByUser = {\n  [VIEWER_ID]: [],\n};\nlet nextTodoId = 0;\naddTodo('Taste JavaScript', true);\naddTodo('Buy a unicorn', false);\naddTodo('todo3', false);\naddTodo('todo4', false);\naddTodo('todo5', false);\naddTodo('todo6', false);\naddTodo('todo7', false);\naddTodo('todo8', false);\n\nexport function addTodo(text, complete) {\n  const todo = new Todo();\n  todo.complete = !!complete;\n  todo.id = `${nextTodoId++}`;\n  todo.text = text;\n  todosById[todo.id] = todo;\n  todoIdsByUser[VIEWER_ID].push(todo.id);\n  return todo.id;\n}\n\nexport function changeTodoStatus(id, complete) {\n\n  const todo = getTodo(id);\n  todo.complete = complete;\n  events.emit('amqp.changes', {id});\n}\n\nexport function getTodo(id) {\n  return todosById[id];\n}\n\nexport function getTodos(status = 'any') {\n  const todos = todoIdsByUser[VIEWER_ID].map(id => todosById[id]);\n  if (status === 'any') {\n    return todos;\n  }\n  return todos.filter(todo => todo.complete === (status === 'completed'));\n}\n\nexport function getUser(id) {\n  return usersById[id];\n}\n\nexport function getViewer() {\n  return getUser(VIEWER_ID);\n}\n\nexport function markAllTodos(complete) {\n  const changedTodos = [];\n  getTodos().forEach(todo => {\n    if (todo.complete !== complete) {\n      todo.complete = complete;\n      changedTodos.push(todo);\n    }\n  });\n  return changedTodos.map(todo => todo.id);\n}\n\nexport function removeTodo(id) {\n  const todoIndex = todoIdsByUser[VIEWER_ID].indexOf(id);\n  if (todoIndex !== -1) {\n    todoIdsByUser[VIEWER_ID].splice(todoIndex, 1);\n  }\n  delete todosById[id];\n}\n\nexport function removeCompletedTodos() {\n  const todosToRemove = getTodos().filter(todo => todo.complete);\n  todosToRemove.forEach(todo => removeTodo(todo.id));\n  return todosToRemove.map(todo => todo.id);\n}\n\nexport function renameTodo(id, text) {\n  const todo = getTodo(id);\n  todo.text = text;\n}\n"]}